<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>One-sample, independent-samples, and paired-samples t-test. — TTEST • bruceR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="One-sample, independent-samples, and paired-samples t-test. — TTEST"><meta property="og:description" content="One-sample, independent-samples, and paired-samples t-test,
with both Frequentist and Bayesian approaches.
The output includes descriptives, t statistics,
mean difference with 95% CI, Cohen's d with 95% CI, and Bayes factor (BF10).
It also tests the assumption of homogeneity of variance
and allows users to determine whether variances are equal or not.
Users can simultaneously test multiple dependent and/or independent variables.
The results of one pair of Y-X would be summarized in one row in the output.
Key results can be saved in APA format to MS Word."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bruceR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.5-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/psychbruce/bruceR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>One-sample, independent-samples, and paired-samples t-test.</h1>
    <small class="dont-index">Source: <a href="https://github.com/psychbruce/bruceR/blob/HEAD/R/bruceR_stats_01_basic.R" class="external-link"><code>R/bruceR_stats_01_basic.R</code></a></small>
    <div class="hidden name"><code>TTEST.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>One-sample, independent-samples, and paired-samples <em>t</em>-test,
with both Frequentist and Bayesian approaches.
The output includes descriptives, <em>t</em> statistics,
mean difference with 95% CI, Cohen's <em>d</em> with 95% CI, and Bayes factor (BF10).
It also tests the assumption of homogeneity of variance
and allows users to determine whether variances are equal or not.</p>
<p>Users can simultaneously test multiple dependent and/or independent variables.
The results of one pair of Y-X would be summarized in one row in the output.
Key results can be saved in APA format to MS Word.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">TTEST</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">y</span>,
  x <span class="op">=</span> <span class="cn">NULL</span>,
  paired <span class="op">=</span> <span class="cn">FALSE</span>,
  var.equal <span class="op">=</span> <span class="cn">TRUE</span>,
  mean.diff <span class="op">=</span> <span class="cn">TRUE</span>,
  test.value <span class="op">=</span> <span class="fl">0</span>,
  test.sided <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"="</span>, <span class="st">"&lt;"</span>, <span class="st">"&gt;"</span><span class="op">)</span>,
  factor.rev <span class="op">=</span> <span class="cn">TRUE</span>,
  bayes.prior <span class="op">=</span> <span class="st">"medium"</span>,
  digits <span class="op">=</span> <span class="fl">2</span>,
  nsmall <span class="op">=</span> <span class="va">digits</span>,
  file <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Data frame (wide-format only, i.e., one case in one row).</p></dd>
<dt>y</dt>
<dd><p>Dependent variable(s).
Multiple variables should be included in a character vector <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>.</p>
<p>For paired-samples <em>t</em>-test, the number of variables should be 2, 4, 6, etc.</p></dd>
<dt>x</dt>
<dd><p>Independent variable(s).
Multiple variables should be included in a character vector <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>.</p>
<p>Only necessary for independent-samples <em>t</em>-test.</p></dd>
<dt>paired</dt>
<dd><p>For paired-samples <em>t</em>-test, set it to <code>TRUE</code>. Default is <code>FALSE</code>.</p></dd>
<dt>var.equal</dt>
<dd><p>If Levene's test indicates a violation of the homogeneity of variance,
then you should better set this argument to <code>FALSE</code>. Default is <code>TRUE</code>.</p></dd>
<dt>mean.diff</dt>
<dd><p>Whether to display results of mean difference and its 95% CI. Default is <code>TRUE</code>.</p></dd>
<dt>test.value</dt>
<dd><p>The true value of the mean (or difference in means for a two-samples test). Default is <code>0</code>.</p></dd>
<dt>test.sided</dt>
<dd><p>Any of <code>"="</code> (two-sided, the default), <code>"&lt;"</code> (one-sided), or <code>"&gt;"</code> (one-sided).</p></dd>
<dt>factor.rev</dt>
<dd><p>Whether to reverse the levels of factor (X)
such that the test compares higher vs. lower level. Default is <code>TRUE</code>.</p></dd>
<dt>bayes.prior</dt>
<dd><p>Prior scale in Bayesian <em>t</em>-test. Default is 0.707.
See details in <code><a href="https://rdrr.io/pkg/BayesFactor/man/ttestBF.html" class="external-link">BayesFactor::ttestBF()</a></code>.</p></dd>
<dt>digits, nsmall</dt>
<dd><p>Number of decimal places of output. Default is <code>2</code>.</p></dd>
<dt>file</dt>
<dd><p>File name of MS Word (<code>.doc</code>).</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Note that the point estimate of Cohen's <em>d</em> is computed using
the common method "Cohen's <em>d</em> = mean difference / (pooled) standard deviation", which is
consistent with results from other R packages (e.g., <code>effectsize</code>) and software (e.g., <code>jamovi</code>).
The 95% CI of Cohen's <em>d</em> is estimated based on the 95% CI of mean difference
(i.e., also divided by the pooled standard deviation).</p>
<p>However, different packages and software diverge greatly on the estimate of the 95% CI of Cohen's <em>d</em>.
R packages such as <code>psych</code> and <code>effectsize</code>, R software <code>jamovi</code>,
and several online statistical tools for estimating effect sizes
indeed produce surprisingly inconsistent results on the 95% CI of Cohen's <em>d</em>.</p>
<p>See an illustration of this issue in the section "Examples".</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="MANOVA.html">MANOVA</a></code>, <code><a href="EMMEANS.html">EMMEANS</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## Demo data ##</span></span>
<span class="r-in"><span class="va">d1</span><span class="op">=</span><span class="va">between.3</span></span>
<span class="r-in"><span class="va">d1</span><span class="op">$</span><span class="va">Y1</span><span class="op">=</span><span class="va">d1</span><span class="op">$</span><span class="va">SCORE</span>  <span class="co"># shorter name for convenience</span></span>
<span class="r-in"><span class="va">d1</span><span class="op">$</span><span class="va">Y2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span>  <span class="co"># random variable</span></span>
<span class="r-in"><span class="va">d1</span><span class="op">$</span><span class="va">B</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d1</span><span class="op">$</span><span class="va">B</span>, levels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">d1</span><span class="op">$</span><span class="va">C</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">d1</span><span class="op">$</span><span class="va">C</span>, levels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">d2</span><span class="op">=</span><span class="va">within.1</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## One-sample t-test ##</span></span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, <span class="st">"SCORE"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">One-Sample t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable  N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE 32 6.31 (2.95)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         t df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: (SCORE - 0)  12.13 31 &lt;.001 ***   6.31 [5.25, 7.37]  2.14 [1.78, 2.50] 2.85e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, <span class="st">"SCORE"</span>, test.value<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">One-Sample t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ ≠ 5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable  N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE 32 6.31 (2.95)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        t df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: (SCORE - 5)  2.52 31  .017 *     1.31 [0.25, 2.37]  0.45 [0.09, 0.81] 2.81e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Independent-samples t-test ##</span></span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, <span class="st">"SCORE"</span>, x<span class="op">=</span><span class="st">"A"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Independent-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable Factor Level  N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE      A     1 16 4.12 (1.45)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE      A     2 16 8.50 (2.37)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levene’s test for homogeneity of variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Levene’s F df1 df2     p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: A (2 - 1)        3.25   1  30  .081 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Note</span>: H0 = equal variance (homoscedasticity).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If significant (violation of the assumption),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> then you should better set `var.equal=FALSE`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      t df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: A (2 - 1)  6.30 30 &lt;.001 ***   4.38 [2.96, 5.79]  2.23 [1.51, 2.95] 1.89e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, <span class="st">"SCORE"</span>, x<span class="op">=</span><span class="st">"A"</span>, var.equal<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Independent-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable Factor Level  N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE      A     1 16 4.12 (1.45)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SCORE      A     2 16 8.50 (2.37)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levene’s test for homogeneity of variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Levene’s F df1 df2     p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: A (2 - 1)        3.25   1  30  .081 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Note</span>: H0 = equal variance (homoscedasticity).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If significant (violation of the assumption),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> then you should better set `var.equal=FALSE`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test (adjusted df):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      t    df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SCORE: A (2 - 1)  6.30 24.92 &lt;.001 ***   4.38 [2.94, 5.81]  2.23 [1.50, 2.96] 1.89e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, y<span class="op">=</span><span class="st">"Y1"</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Independent-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable Factor Level  N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      A  1    16 4.12 (1.45)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      A  2    16 8.50 (2.37)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      B  Low  16 5.69 (1.99)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      B  High 16 6.94 (3.62)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      C  M    16 6.00 (2.34)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      C  F    16 6.62 (3.50)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levene’s test for homogeneity of variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Levene’s F df1 df2     p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: A (2 - 1)             3.25   1  30  .081 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: B (High - Low)        7.85   1  30  .009 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: C (F - M)             1.88   1  30  .181    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Note</span>: H0 = equal variance (homoscedasticity).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If significant (violation of the assumption),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> then you should better set `var.equal=FALSE`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        t df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: A (2 - 1)       6.30 30 &lt;.001 ***  4.38 [ 2.96, 5.79] 2.23 [ 1.51, 2.95] 1.89e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: B (High - Low)  1.21 30  .236      1.25 [-0.86, 3.36] 0.43 [-0.29, 1.15] 5.86e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: C (F - M)       0.59 30  .557      0.62 [-1.52, 2.77] 0.21 [-0.51, 0.93] 3.85e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ─────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d1</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span><span class="op">)</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>,</span>
<span class="r-in">      mean.diff<span class="op">=</span><span class="cn">FALSE</span>,  <span class="co"># remove to save space</span></span>
<span class="r-in">      file<span class="op">=</span><span class="st">"t-result.doc"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Independent-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable Factor Level  N  Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      A  1    16  4.12 (1.45)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      A  2    16  8.50 (2.37)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      B  Low  16  5.69 (1.99)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      B  High 16  6.94 (3.62)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      C  M    16  6.00 (2.34)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y1      C  F    16  6.62 (3.50)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      A  1    16 -0.40 (0.85)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      A  2    16  0.22 (0.66)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      B  Low  16 -0.09 (0.86)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      B  High 16 -0.09 (0.80)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      C  M    16  0.07 (0.97)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Y2      C  F    16 -0.25 (0.61)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levene’s test for homogeneity of variance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Levene’s F df1 df2     p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: A (2 - 1)             3.25   1  30  .081 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: B (High - Low)        7.85   1  30  .009 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1: C (F - M)             1.88   1  30  .181    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2: A (2 - 1)             0.52   1  30  .478    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2: B (High - Low)        0.00   1  30  .985    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2: C (F - M)             1.95   1  30  .173    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Note</span>: H0 = equal variance (homoscedasticity).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> If significant (violation of the assumption),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> then you should better set `var.equal=FALSE`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">√</span> Table saved to <span style="font-weight: bold;">"D:/RStudio/bruceR/docs/reference/t-result.doc"</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"t-result.doc"</span><span class="op">)</span>  <span class="co"># delete file for code check</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Paired-samples t-test ##</span></span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d2</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Paired-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable N Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A1 8 4.38 (1.69)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A2 8 3.88 (1.25)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ───────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        t df     p     Difference [95% CI]  Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Paired: (A2 - A1)  -1.18  7  .275     -0.50 [-1.50, 0.50] -0.42 [-1.25, 0.42] 5.78e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">TTEST</span><span class="op">(</span><span class="va">d2</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">)</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">Paired-Samples t-test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hypothesis: two-sided (μ2 - μ1 ≠ 0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Descriptives:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variable N  Mean (S.D.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A1 8  4.38 (1.69)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A2 8  3.88 (1.25)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A3 8  7.00 (1.31)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        A4 8 10.00 (2.27)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of t-test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        t df     p     Difference [95% CI]  Cohen’s d [95% CI]     BF10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Paired: (A2 - A1)  -1.18  7  .275     -0.50 [-1.50, 0.50] -0.42 [-1.25, 0.42] 5.78e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Paired: (A4 - A3)   2.54  7  .039 *    3.00 [ 0.21, 5.79]  0.90 [ 0.06, 1.73] 2.31e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ──────────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">## Illustration for the issue stated in "Details"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Inconsistency in the 95% CI of Cohen's d between R packages:</span></span>
<span class="r-in">  <span class="co"># In this example, the true point estimate of Cohen's d = 3.00</span></span>
<span class="r-in">  <span class="co"># and its 95% CI should be equal to 95% CI of mean difference.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">data</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, Y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">data</span>  <span class="co"># simple demo data</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">TTEST</span><span class="op">(</span><span class="va">data</span>, y<span class="op">=</span><span class="st">"Y"</span>, x<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [0.73, 5.27] (estimated based on 95% CI of mean difference)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="MANOVA.html">MANOVA</a></span><span class="op">(</span><span class="va">data</span>, dv<span class="op">=</span><span class="st">"Y"</span>, between<span class="op">=</span><span class="st">"X"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span class="r-in">    <span class="fu"><a href="EMMEANS.html">EMMEANS</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [0.73, 5.27] (the same as TTEST)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/cohen.d.html" class="external-link">cohen.d</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span>, group<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.67 [0.04, 7.35] (strange)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/cohen.d.html" class="external-link">d.ci</a></span><span class="op">(</span>d<span class="op">=</span><span class="fl">3.00</span>, n1<span class="op">=</span><span class="fl">3</span>, n2<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [-0.15, 6.12] (significance inconsistent with t-test)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># jamovi uses psych::d.ci() to compute 95% CI</span></span>
<span class="r-in">  <span class="co"># so its results are also: 3.00 [-0.15, 6.12]</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/cohens_d.html" class="external-link">cohens_d</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [0.38, 5.50] (using the noncentrality parameter method)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">effectsize</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/effectsize/reference/t_to_r.html" class="external-link">t_to_d</a></span><span class="op">(</span>t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, data<span class="op">=</span><span class="va">data</span>, var.equal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span class="r-in">                     df_error<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># d = 3.67 [0.47, 6.74] (merely an approximate estimate, often overestimated)</span></span>
<span class="r-in">  <span class="co"># see ?effectsize::t_to_d</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># https://www.psychometrica.de/effect_size.html</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [0.67, 5.33] (slightly different from TTEST)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># https://www.campbellcollaboration.org/escalc/</span></span>
<span class="r-in">  <span class="co"># d = 3.00 [0.67, 5.33] (slightly different from TTEST)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Conclusion:</span></span>
<span class="r-in">  <span class="co"># TTEST() provides a reasonable estimate of Cohen's d and its 95% CI,</span></span>
<span class="r-in">  <span class="co"># and effectsize::cohens_d() offers another method to compute the CI.</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Han-Wu-Shuang Bao.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

